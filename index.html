<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMIC UNIVERSE: ZAKOVAT</title>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Comic+Neue:wght@400;700&family=Permanent+Marker&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF0000;      /* Spider-Red */
            --secondary: #FFDE00;    /* Zap-Yellow */
            --accent: #0099FF;       /* Hero-Blue */
            --dark: #111111;         /* Ink-Black */
            --light: #FFFFFF;
            --purple: #8e44ad;
            --border: 4px solid var(--dark);
            --hard-shadow: 8px 8px 0px var(--dark);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            user-select: none;
        }

        body {
            background-color: #f4f4f4;
            /* Halftone Dots Pattern */
            background-image: radial-gradient(var(--dark) 1px, transparent 1px), radial-gradient(var(--dark) 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            font-family: 'Comic Neue', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- FONTS & TYPOGRAPHY --- */
        h1, h2, h3, .comic-font {
            font-family: 'Bangers', cursive;
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }

        .marker-font { font-family: 'Permanent Marker', cursive; }

        /* --- UTILS --- */
        .hidden { display: none !important; }

        .comic-box {
            background: var(--light);
            border: var(--border);
            box-shadow: var(--hard-shadow);
        }

        .btn {
            background: var(--secondary);
            color: var(--dark);
            border: var(--border);
            padding: 15px 30px;
            font-family: 'Bangers';
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 6px 6px 0 var(--dark);
            transition: all 0.1s;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }
        .btn:hover { transform: translate(-2px, -2px); box-shadow: 10px 10px 0 var(--dark); background: #fff000; }
        .btn:active { transform: translate(4px, 4px); box-shadow: 2px 2px 0 var(--dark); }
        
        .btn-blue { background: var(--accent); color: white; }
        .btn-red { background: var(--primary); color: white; }

        /* --- SCREEN 1: SETUP --- */
        #setup-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
        }

        .logo-container {
            position: relative;
            margin-bottom: 40px;
            transform: rotate(-3deg);
        }
        .logo-text {
            font-size: 5rem;
            color: var(--primary);
            text-shadow: 5px 5px 0 var(--dark);
            -webkit-text-stroke: 2px var(--dark);
            z-index: 2;
            position: relative;
        }
        .logo-bg {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(1.2);
            width: 100%; height: 50px;
            background: var(--secondary);
            z-index: 1;
            border: var(--border);
        }

        .setup-wrapper {
            background: white;
            border: var(--border);
            padding: 40px;
            width: 100%;
            max-width: 1000px;
            box-shadow: 15px 15px 0 var(--dark);
        }

        /* Topics (Image Cards) */
        .topics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .topic-card {
            height: 350px;
            border: var(--border);
            position: relative;
            cursor: pointer;
            transition: 0.3s;
            background: black;
        }

        .topic-card img {
            width: 100%; height: 100%;
            object-fit: cover;
            opacity: 0.7;
            transition: 0.4s;
            /* Comic Filter Effect */
            filter: grayscale(100%) contrast(1.2);
        }

        .topic-overlay {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background: var(--secondary);
            border-top: var(--border);
            padding: 15px;
            text-align: center;
            clip-path: polygon(0 0, 100% 10%, 100% 100%, 0 100%);
            margin-top: -10px;
        }

        .topic-card:hover { transform: translateY(-10px); box-shadow: 10px 10px 0 var(--dark); }
        .topic-card:hover img { opacity: 1; filter: grayscale(0%) saturate(1.4) contrast(1.2); }
        
        .topic-card.selected {
            transform: scale(1.05); z-index: 10;
            border-color: var(--primary);
            box-shadow: 0 0 0 5px var(--primary), 15px 15px 0 var(--dark);
        }
        .topic-card.selected img { opacity: 1; filter: grayscale(0%) saturate(1.4) contrast(1.2); }

        /* Team Selector */
        .team-row { display: flex; gap: 15px; justify-content: center; margin-bottom: 30px; }
        .t-opt {
            width: 70px; height: 70px;
            border: var(--border); background: white;
            display: flex; align-items: center; justify-content: center;
            font-family: 'Bangers'; font-size: 2rem; cursor: pointer;
        }
        .t-opt.active { background: var(--primary); color: white; transform: rotate(-5deg) scale(1.1); box-shadow: 5px 5px 0 var(--dark); }

        /* --- SCREEN 2: GAME --- */
        #game-screen { display: flex; height: 100vh; }
        
        .sidebar {
            width: 300px; background: white; border-right: var(--border);
            padding: 20px; display: flex; flex-direction: column; z-index: 5;
        }
        
        .score-panel {
            background: #fff; border: 3px solid var(--dark);
            margin-bottom: 15px; padding: 10px; position: relative; transition: 0.3s;
        }
        .score-panel.turn {
            background: var(--secondary); transform: scale(1.05) rotate(2deg);
            box-shadow: 5px 5px 0 rgba(0,0,0,0.2); z-index: 10;
        }
        .score-panel.turn::after {
            content: 'NAVBAT'; position: absolute; top: -15px; right: -5px;
            background: var(--primary); color: white; font-family: 'Bangers';
            padding: 2px 8px; border: 2px solid black; transform: rotate(10deg);
        }

        .main-board { flex: 1; padding: 30px; overflow-y: auto; background: rgba(255,255,255,0.8); }

        .board-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 30px; border-bottom: 4px solid var(--dark); padding-bottom: 10px;
        }

        .grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px;
        }

        .card {
            aspect-ratio: 0.85;
            background: white; border: var(--border);
            position: relative; cursor: pointer;
            box-shadow: 6px 6px 0 rgba(0,0,0,0.1);
            transition: 0.2s;
            overflow: hidden;
            display: flex; flex-direction: column;
            justify-content: flex-end; /* Text at bottom */
        }
        
        /* Card Image Cover */
        .card-cover-img {
            position: absolute; top: 0; left: 0; width: 100%; height: 80%;
            object-fit: cover; opacity: 0.8; filter: grayscale(100%);
            transition: 0.3s;
        }
        .card-num {
            height: 20%; width: 100%;
            background: var(--secondary); border-top: 3px solid var(--dark);
            display: flex; justify-content: center; align-items: center;
            font-family: 'Bangers'; font-size: 1.5rem;
            position: relative; z-index: 2;
        }

        .card:hover { transform: translate(-5px, -5px); box-shadow: 12px 12px 0 var(--dark); z-index: 5; border-color: var(--primary); }
        .card:hover .card-cover-img { height: 100%; opacity: 1; filter: grayscale(0%); }
        .card.done { pointer-events: none; opacity: 0.5; filter: grayscale(100%); transform: none; box-shadow: none; border-style: dashed; }

        /* --- MODAL (COMIC STRIP) --- */
        .modal-wrap {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 100;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: 0.3s;
        }
        .modal-wrap.open { opacity: 1; pointer-events: all; }

        .comic-page {
            background: white; width: 90%; max-width: 800px;
            border: 6px solid var(--dark);
            box-shadow: 20px 20px 0 var(--primary);
            transform: rotate(-1deg);
            display: grid; grid-template-rows: auto 1fr auto;
            max-height: 90vh; overflow-y: auto;
        }
        
        .page-header { background: var(--secondary); padding: 15px; border-bottom: 4px solid var(--dark); display: flex; justify-content: space-between; }
        .page-content { padding: 30px; text-align: center; background: radial-gradient(#fff, #eee); }

        .speech-bubble {
            background: white; border: 4px solid var(--dark);
            border-radius: 40px; padding: 25px;
            position: relative; margin-bottom: 30px;
            font-size: 1.5rem; font-weight: bold;
            box-shadow: 5px 5px 0 rgba(0,0,0,0.1);
        }
        .speech-bubble::before {
            content: ''; position: absolute; bottom: -20px; left: 50%;
            border-width: 20px 20px 0; border-style: solid; border-color: var(--dark) transparent transparent;
        }

        .answer-splash {
            display: none;
            background: var(--dark); color: var(--secondary);
            font-family: 'Permanent Marker'; font-size: 2.2rem;
            padding: 20px; transform: rotate(2deg);
            border: 4px solid white; box-shadow: 10px 10px 0 rgba(0,0,0,0.3);
            margin-top: 20px; animation: kaboom 0.4s ease-out;
        }

        @keyframes kaboom {
            0% { transform: scale(0.1) rotate(-20deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(10deg); }
            70% { transform: scale(0.9) rotate(-5deg); }
            100% { transform: scale(1) rotate(2deg); opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            #game-screen { flex-direction: column; }
            .sidebar { width: 100%; flex-direction: row; border-right: 0; border-bottom: 4px solid black; padding: 10px; overflow-x: auto; }
            .score-panel { min-width: 140px; margin-right: 10px; margin-bottom: 0; }
            .logo-text { font-size: 3.5rem; }
            .topic-card { height: 250px; }
            .card-num { font-size: 1.2rem; }
        }
    </style>
</head>
<body>

<!-- 1. SETUP -->
<div id="setup-screen">
    <div class="logo-container">
        <div class="logo-bg"></div>
        <h1 class="logo-text">COMIC UNIVERSE</h1>
    </div>

    <div class="setup-wrapper">
        <h2 style="text-align: center; margin-bottom: 20px;">JAMOALAR SONI:</h2>
        <div class="team-row">
            <div class="t-opt" onclick="setTeams(2)">2</div>
            <div class="t-opt" onclick="setTeams(3)">3</div>
            <div class="t-opt active" onclick="setTeams(4)">4</div>
        </div>

        <h2 style="text-align: center; margin-bottom: 20px;">MAVZU TANLASH (BOSING):</h2>
        <div class="topics-grid" id="topics-render">
            <!-- JS renders here -->
        </div>

        <div style="text-align: center; margin-top: 40px;">
            <button class="btn btn-red" onclick="startGame()" style="font-size: 2rem;">O'YINNI BOSHLASH</button>
        </div>
    </div>
</div>

<!-- 2. GAME -->
<div id="game-screen" class="hidden">
    <div class="sidebar">
        <h2 class="comic-font" style="font-size: 2rem; color: var(--primary); margin-bottom: 15px;">HISOB</h2>
        <div id="scoreboard"></div>
        <button class="btn" style="margin-top: auto; font-size: 1rem;" onclick="location.reload()">MENU</button>
    </div>

    <div class="main-board">
        <div class="board-header">
            <h2 id="active-topic-header" style="background: var(--secondary); padding: 5px 15px; border: 3px solid black; transform: skew(-10deg);">MAVZU</h2>
            <h3 class="comic-font">QOLDI: <span id="cards-left" style="color: var(--primary); font-size: 1.5rem;">16</span></h3>
        </div>
        <div class="grid" id="game-grid">
            <!-- Cards -->
        </div>
    </div>
</div>

<!-- 3. MODAL -->
<div class="modal-wrap" id="modal">
    <div class="comic-page">
        <div class="page-header">
            <span class="comic-font" style="font-size: 1.5rem;">MISSION</span>
            <span id="m-points" style="font-family: 'Bangers'; background: var(--primary); color: white; padding: 2px 10px; border: 2px solid black;">20 XP</span>
        </div>
        <div class="page-content">
            <div class="speech-bubble" id="m-question">
                Savol matni...
            </div>

            <button id="btn-reveal" class="btn btn-blue" style="width: 100%;" onclick="reveal()">JAVOBNI KO'RSATISH ðŸ’¥</button>

            <div id="answer-section" style="display: none;">
                <div class="answer-splash" id="m-answer">JAVOB</div>
                <div style="display: flex; gap: 20px; margin-top: 30px;">
                    <button class="btn btn-red" style="flex: 1;" onclick="resolve(false)">XATO (0)</button>
                    <button class="btn" style="flex: 1; background: var(--accent); color: white;" onclick="resolve(true)">TO'G'RI (+)</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 4. VICTORY -->
<div class="modal-wrap" id="victory-modal">
    <div class="comic-box" style="padding: 50px; text-align: center; transform: rotate(-3deg);">
        <h1 class="comic-font" style="font-size: 4rem; color: var(--primary); text-shadow: 3px 3px 0 black;">G'OLIB!</h1>
        <h2 id="winner-name" style="font-size: 3rem; margin: 20px 0;">TEAM 1</h2>
        <button class="btn btn-blue" onclick="location.reload()">YANGI O'YIN</button>
    </div>
</div>

<script>
    /* --- PROFESSIONAL DATA --- */
    // Images are selected for comic/pop-art style
    const topics = [
        {
            id: 'hero',
            title: 'SUPER QAHRAMONLAR',
            img: 'https://images.unsplash.com/photo-1612036782180-6f0b6cd846fe?q=80&w=800&auto=format&fit=crop', // Comic books stack
            questions: [
                {q: "O'rgimchak odamning (Spider-Man) haqiqiy ismi nima?", a: "Piter Parker", p: 10},
                {q: "Supermenning zaif tomoni nima?", a: "Kriptonit", p: 15},
                {q: "Betmen (Batman) qaysi shaharda yashaydi?", a: "Gotem (Gotham)", p: 10},
                {q: "Temir odam (Iron Man) kim?", a: "Toni Stark", p: 10},
                {q: "Qasoskorlar (Avengers) jamoasining sardori kim?", a: "Kapitan Amerika", p: 15},
                {q: "Torning quroli nima?", a: "Mjolnir (Bolg'a)", p: 10},
                {q: "Xalk (Hulk) qanday rangda?", a: "Yashil", p: 10},
                {q: "Qora Pantera qaysi davlat qiroli?", a: "Vakanda", p: 20},
                {q: "Joker kimning asosiy dushmani?", a: "Betmenning", p: 15},
                {q: "Wonder Woman qaysi mifologiyadan?", a: "Yunon (Amazonka)", p: 20},
                {q: "Dedpul (Deadpool) qaysi rangdagi kiyimda?", a: "Qizil va Qora", p: 10},
                {q: "Tanosh qancha tosh yig'ishi kerak edi?", a: "6 ta abadiyat toshini", p: 25},
                {q: "Akvamen qayerda yashaydi?", a: "Atlantida", p: 15},
                {q: "Loki kimning ukasi?", a: "Torning", p: 10},
                {q: "Groot qaysi filmda qatnashgan?", a: "Galaktika Qo'riqchilari", p: 15},
                {q: "Doktor Strenj kasbi nima bo'lgan?", a: "Neyroxirurg", p: 20}
            ]
        },
        {
            id: 'detective',
            title: 'MANTIQ VA DETEKTIV',
            img: 'https://images.unsplash.com/photo-1455577380025-4321f1e1dca7?q=80&w=800&auto=format&fit=crop', // Dark moody lighting
            questions: [
                {q: "3 ta haydovchi bor, 2 tasi uxlab qoldi. Nechta haydovchi qoldi?", a: "3 ta (Uxlasa ham haydovchi)", p: 20},
                {q: "Sherlok Xolmsning yordamchisi kim?", a: "Doktor Vatson", p: 10},
                {q: "Stolning 4 burchagi bor. Birini kessak nechta qoladi?", a: "5 ta", p: 15},
                {q: "Bo'sh qopda nima bor?", a: "Havo", p: 10},
                {q: "Qaysi oyda 28 kun bor?", a: "Barcha 12 oyda", p: 10},
                {q: "Qotil jinoyat joyida soatini qoldirdi. Bu nima?", a: "Dalil", p: 10},
                {q: "Yomg'ir 2 kun ketma-ket yog'ishi mumkinmi?", a: "Yo'q (tun kiradi)", p: 15},
                {q: "Nimani yerdan ko'tarish oson, lekin uzoq otib bo'lmaydi?", a: "Parranda pati", p: 20},
                {q: "Qaysi idishdan ovqat yeb bo'lmaydi?", a: "Bo'sh idishdan", p: 10},
                {q: "Elektr poyezdi janubga ketyapti, tutun qayerga?", a: "Tutun bo'lmaydi", p: 15},
                {q: "Tuxumni betonga urib sindirmaslik mumkinmi?", a: "Ha, beton qattiq", p: 15},
                {q: "Erkyul Puaro qaysi millatga mansub?", a: "Belgiyalik", p: 25},
                {q: "Qora mushuk qachon uyga kirishi oson?", a: "Eshik ochiq bo'lsa", p: 10},
                {q: "Suv qachon qaynaydi?", a: "100 gradusda", p: 10},
                {q: "Qaysi so'z doim xato yoziladi?", a: "\"Xato\" so'zi", p: 10},
                {q: "Insonning qaysi a'zosi o'lgunicha o'sadi?", a: "Burun va Quloq", p: 15}
            ]
        },
        {
            id: 'world',
            title: 'DUNYO MO\'JIZALARI',
            img: 'https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?q=80&w=800&auto=format&fit=crop', // Travel map
            questions: [
                {q: "Fransiya poytaxti?", a: "Parij", p: 10},
                {q: "Eng baland cho'qqi?", a: "Everest", p: 15},
                {q: "Misr ehromlari qayerda?", a: "Giza", p: 10},
                {q: "Dunyodagi eng uzun daryo?", a: "Nil", p: 15},
                {q: "Xitoy devori kosmosdan ko'rinadimi?", a: "Yo'q (Mif)", p: 20},
                {q: "Antarktida davlatmi?", a: "Yo'q (Qit'a)", p: 10},
                {q: "Braziliya tili?", a: "Portugal", p: 20},
                {q: "Italiya poytaxti?", a: "Rim", p: 10},
                {q: "AQSh bayrog'ida nechta yulduz bor?", a: "50 ta", p: 20},
                {q: "Yaponiya puli?", a: "Iyena", p: 15},
                {q: "Toj Mahal qayerda?", a: "Hindiston", p: 10},
                {q: "Turkiya poytaxti?", a: "Anqara", p: 15},
                {q: "Big Ben qayerda?", a: "London", p: 10},
                {q: "Eng kichik davlat?", a: "Vatikan", p: 25},
                {q: "O'zbekistondagi qadimiy shahar?", a: "Samarqand", p: 15},
                {q: "Sahroi Kabir qayerda?", a: "Afrika", p: 10}
            ]
        }
    ];

    /* --- GAME LOGIC --- */
    let gameState = {
        teams: [],
        teamCount: 4,
        topicIdx: 0,
        turn: 0,
        activeCard: null,
        currentQ: null,
        cardsLeft: 0
    };

    function init() {
        const container = document.getElementById('topics-render');
        topics.forEach((t, i) => {
            container.innerHTML += `
                <div class="topic-card ${i===0?'selected':''}" onclick="selectTopic(${i}, this)">
                    <img src="${t.img}">
                    <div class="topic-overlay">
                        <h2 class="comic-font">${t.title}</h2>
                    </div>
                </div>
            `;
        });
    }

    function selectTopic(idx, el) {
        gameState.topicIdx = idx;
        document.querySelectorAll('.topic-card').forEach(e => e.classList.remove('selected'));
        el.classList.add('selected');
    }

    function setTeams(n) {
        gameState.teamCount = n;
        document.querySelectorAll('.t-opt').forEach(e => e.classList.remove('active'));
        event.target.classList.add('active');
    }

    function startGame() {
        gameState.teams = Array.from({length: gameState.teamCount}, (_, i) => ({
            name: `JAMOA ${i+1}`, score: 0
        }));

        const qList = [...topics[gameState.topicIdx].questions].sort(() => 0.5 - Math.random()).slice(0, 16);
        gameState.cardsLeft = qList.length;

        document.getElementById('setup-screen').classList.add('hidden');
        document.getElementById('game-screen').classList.remove('hidden');
        document.getElementById('active-topic-header').innerText = topics[gameState.topicIdx].title;
        document.getElementById('cards-left').innerText = gameState.cardsLeft;

        renderScoreboard();
        renderGrid(qList);
    }

    function renderScoreboard() {
        const board = document.getElementById('scoreboard');
        board.innerHTML = '';
        gameState.teams.forEach((t, i) => {
            const active = i === gameState.turn ? 'turn' : '';
            board.innerHTML += `
                <div class="score-panel ${active}">
                    <div class="comic-font" style="font-size: 1.1rem;">${t.name}</div>
                    <div class="comic-font" style="font-size: 2.2rem; color: var(--primary);">${t.score}</div>
                </div>
            `;
        });
    }

    function renderGrid(questions) {
        const grid = document.getElementById('game-grid');
        grid.innerHTML = '';
        // Image for cards (using a generic comic splash or the topic image)
        const coverImg = topics[gameState.topicIdx].img;

        questions.forEach((q, i) => {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <img src="${coverImg}" class="card-cover-img">
                <div class="card-num">${i + 1}</div>
            `;
            card.onclick = () => openModal(card, q);
            // Stagger animation
            card.style.opacity = '0';
            setTimeout(() => { card.style.opacity = '1'; }, i * 50);
            grid.appendChild(card);
        });
    }

    /* --- MODAL LOGIC --- */
    function openModal(card, q) {
        if(card.classList.contains('done')) return;
        gameState.activeCard = card;
        gameState.currentQ = q;

        document.getElementById('m-points').innerText = q.p + " XP";
        document.getElementById('m-question').innerText = q.q;
        document.getElementById('m-answer').innerText = q.a;

        // Reset
        document.getElementById('btn-reveal').style.display = 'block';
        document.getElementById('answer-section').style.display = 'none';

        document.getElementById('modal').classList.add('open');
    }

    function reveal() {
        document.getElementById('btn-reveal').style.display = 'none';
        const ansSec = document.getElementById('answer-section');
        ansSec.style.display = 'block';
        
        // Sound effect visual
        const ansSplash = document.getElementById('m-answer');
        ansSplash.style.display = 'block';
    }

    function resolve(correct) {
        const card = gameState.activeCard;
        if(correct) {
            gameState.teams[gameState.turn].score += gameState.currentQ.p;
            card.style.borderColor = 'var(--accent)';
            card.querySelector('.card-num').style.background = 'var(--accent)';
            card.querySelector('.card-num').innerText = "POW!";
        } else {
            card.style.borderColor = '#aaa';
            card.querySelector('.card-num').style.background = '#ccc';
            card.querySelector('.card-num').innerText = "OOPS";
        }
        card.classList.add('done');
        
        document.getElementById('modal').classList.remove('open');
        
        gameState.turn = (gameState.turn + 1) % gameState.teamCount;
        gameState.cardsLeft--;
        document.getElementById('cards-left').innerText = gameState.cardsLeft;
        
        renderScoreboard();
        
        if(gameState.cardsLeft === 0) endGame();
    }

    function endGame() {
        const max = Math.max(...gameState.teams.map(t => t.score));
        const winners = gameState.teams.filter(t => t.score === max);
        const name = winners.length > 1 ? "DURRANG!" : winners[0].name + " G'OLIB!";
        
        document.getElementById('winner-name').innerText = name;
        document.getElementById('victory-modal').classList.add('open');
    }

    init();
</script>
</body>
</html>

